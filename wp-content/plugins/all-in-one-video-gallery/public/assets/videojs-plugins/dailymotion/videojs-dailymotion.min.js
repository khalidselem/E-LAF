/*! @name videojs-dailymotion @version 1.2.0 @license Apache-2.0 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e=e||self).videojsDailymotion=t(e.videojs)}(this,function(e){"use strict";var t,i,o,a,n,r,s,l,d=(e=e&&e.hasOwnProperty("default")?e.default:e).browser.IS_IOS||e.browser.IS_NATIVE_ANDROID,u=e.getComponent("Tech"),c=function(t){var i,o;function a(e,i){var o;return(o=t.call(this,e,i)||this).dailymotionState={state:"unstarted"},o.setPoster(e.poster),o.setSrc(o.options_.source),o.setTimeout(function(){this.el_&&(this.el_.parentNode.className+=" vjs-dailymotion",d&&(this.el_.parentNode.className+=" vjs-dailymotion-mobile"),a.isApiReady?this.initDailymotionPlayer():a.apiReadyQueue.push(this))}.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(o))),o}o=t,(i=a).prototype=Object.create(o.prototype),i.prototype.constructor=i,i.__proto__=o;var n=a.prototype;return n.dispose=function(){if(this.dailymotionPlayer)this.dailymotionPlayer.destroy&&this.dailymotionPlayer.destroy(this.options_.techId);else{var e=a.apiReadyQueue.indexOf(this);-1!==e&&a.apiReadyQueue.splice(e,1)}this.dailymotionPlayer=null,this.el_.parentNode.className=this.el_.parentNode.className.replace(" vjs-dailymotion","").replace(" vjs-dailymotion-mobile",""),this.el_.parentNode.removeChild(this.el_),t.prototype.dispose.call(this)},n.createEl=function(){var e=document.createElement("div");e.setAttribute("id",this.options_.techId),e.setAttribute("style","position:absolute;top:0;left:0;width:100%;height:100%"),e.setAttribute("class","vjs-tech");var t=document.createElement("div");if(t.appendChild(e),!d&&!this.options_.dailymotionControls){var i=document.createElement("div");i.setAttribute("class","vjs-iframe-blocker"),i.setAttribute("style","position:absolute;top:0;left:0;width:100%;height:100%"),t.appendChild(i)}return t},n.initDailymotionPlayer=function(){var e={controls:!1,autoplay:!1,mute:!1,"ui-logo":!1,"ui-start-screen-info":!1,"sharing-enable":!1,"queue-autoplay-next":!1,"queue-enable":!1};if(void 0!==this.options_.dailymotionControls&&(e.controls=!!this.options_.dailymotionControls),void 0!==this.options_.muted&&(e.mute=!!this.options_.muted),void 0!==this.options_.loop&&(e.loop=!!this.options_.loop),void 0!==this.options_.start&&(e.start=this.options_.start),void 0!==this.options_.customVars){var t=this.options_.customVars;Object.keys(t).forEach(function(i){e[i]=t[i]})}this.activeVideoId=this.url?this.url.videoId:null,this.dailymotionPlayer=new DM.player(this.options_.techId,{width:"100%",height:"100%",video:this.activeVideoId,params:e}),this.trigger("loadstart");for(var i=["apiready","play","playing","pause","end","waiting","progress","timeupdate","seeking","seeked","durationchange","volumechange","error"],o=this.onPlayerStateChange.bind(this),a=0;a<i.length;a++)this.dailymotionPlayer.addEventListener(i[a],o)},n.onPlayerReady=function(){this.isReady_=!0,this.triggerReady(),this.trigger("loadedmetadata"),this.trigger("loadeddata"),this.trigger("canplay"),this.trigger("canplaythrough"),this.trigger("volumechange"),this.playOnReady&&this.play()},n.onPlayerStateChange=function(e){var t=e.type;switch(this.lastState=t,t){case"apiready":this.dailymotionState.state="ready",this.onPlayerReady();break;case"play":this.dailymotionState.state="play",this.trigger("play");break;case"playing":this.dailymotionState.state="playing",this.trigger("playing");break;case"pause":this.dailymotionState.state="paused",this.trigger("pause");break;case"end":this.dailymotionState.state="ended",this.trigger("ended");break;case"waiting":this.dailymotionState.state="buffering",this.trigger("waiting");break;case"progress":this.trigger("progress");break;case"timeupdate":this.trigger("timeupdate");break;case"seeking":this.isSeeking=!0,this.trigger("seeking");break;case"seeked":this.isSeeking=!1,this.trigger("seeked");break;case"durationchange":this.trigger("durationchange");break;case"volumechange":this.trigger("volumechange");break;case"error":console.log(e)}},n.error=function(){return this.dailymotionPlayer&&this.dailymotionPlayer.error},n.poster=function(){return d?null:this.poster_},n.setPoster=function(e){this.poster_=e},n.loadVideoById_=function(e){this.dailymotionPlayer&&this.dailymotionPlayer.load(e)},n.cueVideoById_=function(e){this.dailymotionPlayer&&this.dailymotionPlayer.load(e)},n.src=function(e){return e&&this.setSrc({src:e}),this.source},n.setSrc=function(e){e&&e.src&&(this.source=e,this.url=a.parseUrl(e.src),this.options_.autoplay&&!d?this.isReady_?this.play():(this.trigger("waiting"),this.playOnReady=!0):this.activeVideoId!==this.url.videoId&&(this.isReady_?(this.cueVideoById_(this.url.videoId),this.activeVideoId=this.url.videoId):this.cueOnReady=!0))},n.autoplay=function(){return this.options_.autoplay},n.setAutoplay=function(e){this.options_.autoplay=e},n.loop=function(){return this.options_.loop},n.setLoop=function(e){this.options_.loop=e},n.play=function(){this.url&&this.url.videoId&&(this.isReady_?this.activeVideoId===this.url.videoId?this.dailymotionPlayer.play():(this.loadVideoById_(this.url.videoId),this.activeVideoId=this.url.videoId):(this.trigger("waiting"),this.playOnReady=!0))},n.pause=function(){this.dailymotionPlayer&&this.dailymotionPlayer.pause()},n.paused=function(){return this.dailymotionPlayer&&this.dailymotionPlayer.paused},n.currentTime=function(){return this.dailymotionPlayer?this.dailymotionPlayer.currentTime:0},n.setCurrentTime=function(e){this.dailymotionPlayer&&this.dailymotionPlayer.seek(e)},n.seeking=function(){return this.isSeeking},n.seekable=function(){return this.dailymotionPlayer?e.createTimeRange(0,this.dailymotionPlayer.duration):e.createTimeRange()},n.playbackRate=function(){return 1},n.setPlaybackRate=function(e){},n.duration=function(){return this.dailymotionPlayer?this.dailymotionPlayer.duration:0},n.currentSrc=function(){return this.source&&this.source.src},n.ended=function(){return this.dailymotionPlayer&&this.dailymotionPlayer.ended},n.volume=function(){return this.dailymotionPlayer?this.dailymotionPlayer.volume:1},n.setVolume=function(e){this.dailymotionPlayer&&this.dailymotionPlayer.setVolume(e)},n.muted=function(){return!!this.dailymotionPlayer&&this.dailymotionPlayer.muted},n.setMuted=function(e){this.dailymotionPlayer&&this.dailymotionPlayer.setMuted(e)},n.buffered=function(){return this.dailymotionPlayer?e.createTimeRange(0,this.dailymotionPlayer.bufferedTime):e.createTimeRange()},n.supportsFullScreen=function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled},n.preload=function(){},n.load=function(){},n.reset=function(){},n.networkState=function(){if(!this.dailymotionPlayer)return 0;switch(this.dailymotionState.state){case"unstarted":return 0;case"buffering":return 2;default:return 1}},n.readyState=function(){if(!this.dailymotionPlayer)return 0;switch(this.dailymotionState.state){case"unstarted":return 0;case"ready":return 1;case"buffering":return 2;default:return 4}},a}(u);return c.prototype.featuresTimeupdateEvents=!0,c.isSupported=function(){return!0},c.parseUrl=function(e){var t={videoId:null},i=e.match(/^.+dailymotion.com\/((video|hub)\/([^_]+))?[^#]*(#video=([^_&]+))?/);return i&&(t.videoId=i[5]||i[3]),t},u.withSourceHandlers(c),c.nativeSourceHandler={},c.nativeSourceHandler.canPlayType=function(e){return"video/dailymotion"===e?"maybe":""},c.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return c.nativeSourceHandler.canPlayType(e.type);if(e.src){var i=/dailymotion.com/.test(e.src)?"video/dailymotion":"";return c.nativeSourceHandler.canPlayType(i)}return""},c.nativeSourceHandler.handleSource=function(e,t,i){t.setSrc(e.src)},c.nativeSourceHandler.dispose=function(){},c.registerSourceHandler(c.nativeSourceHandler),c.apiReadyQueue=[],"undefined"!=typeof document&&(a="https://api.dmcdn.net/all.js",n=function(){DM.init({apiKey:null,status:!0,cookie:!0}),c.isApiReady=!0;for(var e=0;e<c.apiReadyQueue.length;++e)c.apiReadyQueue[e].initDailymotionPlayer()},r=!1,s=document.createElement("script"),(l=document.getElementsByTagName("script")[0]).parentNode.insertBefore(s,l),s.onload=function(){r||(r=!0,n())},s.onreadystatechange=function(){r||"complete"!==this.readyState&&"loaded"!==this.readyState||(r=!0,n())},s.src=a,t=".vjs-dailymotion iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }.vjs-dailymotion .vjs-iframe-blocker { display: none; }.vjs-dailymotion.vjs-has-started .vjs-iframe-blocker { display: block; }.vjs-dailymotion .vjs-poster { background-size: cover; }",i=document.head||document.getElementsByTagName("head")[0],(o=document.createElement("style")).type="text/css",o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t)),i.appendChild(o)),c.VERSION="1.2.0",u.registerTech("Dailymotion",c),c});
